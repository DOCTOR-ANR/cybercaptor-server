<topology>
  <machine>
    <name>client</name>
    <security_requirement>1</security_requirement>
    <controllers>
      <controller>orchestrateur_global</controller>
    </controllers>
    <interfaces>
      <interface>
        <name>eth0</name>
        <ipaddress>10.0.1.1</ipaddress>
        <vlan>
          <name>vlan1</name>
          <label>vlan1</label>
        </vlan>
      </interface>
    </interfaces>
    <services />
    <routes>
      <route>
        <destination>0.0.0.0</destination>
        <mask>0.0.0.0</mask>
        <gateway>10.0.1.254</gateway>
        <interface>eth0</interface>
      </route>
    </routes>
  </machine>
  <machine>
    <name>firewall1</name>
    <security_requirement>1</security_requirement>
    <physical_host>
      <hostname>host1</hostname>
      <hypervisor>kvm</hypervisor>
      <user>root</user>
    </physical_host>
    <controllers>
      <controller>orchestrateur_global</controller>
    </controllers>
    <interfaces>
      <interface>
        <name>eth0</name>
        <ipaddress>10.0.1.2</ipaddress>
        <vlan>
          <name>vlan1</name>
          <label>vlan1</label>
        </vlan>
      </interface>
      <interface>
        <name>eth1</name>
        <ipaddress>10.0.2.1</ipaddress>
        <vlan>
          <name>vlan2</name>
          <label>vlan2</label>
        </vlan>
      </interface>
    </interfaces>
    <services />
    <routes />
  </machine>
  <machine>
    <name>igw</name>
    <security_requirement>1</security_requirement>
    <physical_host>
      <hostname>host1</hostname>
      <hypervisor>kvm</hypervisor>
      <user>root</user>
    </physical_host>
    <controllers>
      <controller>orchestrateur_global</controller>
    </controllers>
    <interfaces>
      <interface>
        <name>eth0</name>
        <ipaddress>10.0.2.2</ipaddress>
        <vlan>
          <name>vlan2</name>
          <label>vlan2</label>
        </vlan>
      </interface>
    </interfaces>
    <faces>
      <face>
        <name>r1</name>
      </face>
    </faces>
    <services>
      <service>
        <name>igw-daemon</name>
        <ipaddress>10.0.2.2</ipaddress>
        <protocol>tcp</protocol>
        <port>80</port>
        <vulnerabilities>
          <vulnerability>
            <type>remoteExploit</type>
            <cve>CVE-2013-2249</cve>
            <goal>privEscalation</goal>
            <cvss>7.5</cvss>
          </vulnerability>
        </vulnerabilities>
      </service>
    </services>
    <routes>
      <route>
        <destination>0.0.0.0</destination>
        <mask>0.0.0.0</mask>
        <gateway>10.0.2.254</gateway>
        <interface>eth0</interface>
      </route>
    </routes>
  </machine>
  <machine>
    <name>egw</name>
    <security_requirement>1</security_requirement>
    <physical_host>
      <hostname>host4</hostname>
      <hypervisor>kvm</hypervisor>
      <user>root</user>
    </physical_host>
    <controllers>
      <controller>orchestrateur_global</controller>
    </controllers>
    <interfaces>
      <interface>
        <name>eth0</name>
        <ipaddress>10.0.3.1</ipaddress>
        <vlan>
          <name>vlan3</name>
          <label>vlan3</label>
        </vlan>
      </interface>
    </interfaces>
    <faces>
      <face>
        <name>r6</name>
      </face>
    </faces>
    <services>
      <service>
        <name>egw-daemon</name>
        <protocol>ndn</protocol>
        <port>0</port>
        <vulnerabilities>
          <vulnerability>
            <type>remoteExploit</type>
            <cve>CVE-2013-2249</cve>
            <goal>privEscalation</goal>
            <cvss>7.5</cvss>
          </vulnerability>
        </vulnerabilities>
      </service>
    </services>
    <routes>
      <route>
        <destination>0.0.0.0</destination>
        <mask>0.0.0.0</mask>
        <gateway>10.0.3.254</gateway>
        <interface>eth0</interface>
      </route>
    </routes>
  </machine>
  <machine>
    <name>firewall2</name>
    <security_requirement>1</security_requirement>
    <physical_host>
      <hostname>host4</hostname>
      <hypervisor>kvm</hypervisor>
      <user>root</user>
    </physical_host>
    <controllers>
      <controller>orchestrateur_global</controller>
    </controllers>
    <interfaces>
      <interface>
        <name>eth0</name>
        <ipaddress>10.0.3.2</ipaddress>
        <vlan>
          <name>vlan3</name>
          <label>vlan3</label>
        </vlan>
      </interface>
      <interface>
        <name>eth1</name>
        <ipaddress>10.0.4.1</ipaddress>
        <vlan>
          <name>vlan4</name>
          <label>vlan4</label>
        </vlan>
      </interface>
    </interfaces>
    <services />
    <routes />
  </machine>
  <machine>
    <name>server</name>
    <security_requirement>1</security_requirement>
    <controllers>
      <controller>orchestrateur_global</controller>
    </controllers>
    <interfaces>
      <interface>
        <name>eth0</name>
        <ipaddress>10.0.4.2</ipaddress>
        <vlan>
          <name>vlan4</name>
          <label>vlan4</label>
        </vlan>
      </interface>
    </interfaces>
    <services>
      <service>
        <name>apache2</name>
        <ipaddress>10.0.4.2</ipaddress>
        <protocol>tcp</protocol>
        <port>80</port>
        <vulnerabilities>
          <vulnerability>
            <type>remoteExploit</type>
            <cve>CVE-2013-2249</cve>
            <goal>privEscalation</goal>
            <cvss>7.5</cvss>
          </vulnerability>
        </vulnerabilities>
      </service>
    </services>
    <routes>
      <route>
        <destination>0.0.0.0</destination>
        <mask>0.0.0.0</mask>
        <gateway>10.0.4.254</gateway>
        <interface>eth0</interface>
      </route>
    </routes>
  </machine>
  <machine>
    <name>host1</name>
    <security_requirement>1</security_requirement>
    <controllers>
      <controller>orchestrateur_global</controller>
    </controllers>
    <interfaces>
      <interface>
        <name>eth0</name>
        <ipaddress>192.168.1.1</ipaddress>
        <vlan>
          <name>vlan0</name>
          <label>vlan0</label>
        </vlan>
      </interface>
    </interfaces>
    <services>
      <service>
        <name>kvm</name>
        <ipaddress>192.168.1.1</ipaddress>
        <protocol>none</protocol>
        <port>0</port>
        <global_name>host1_kvm</global_name>
        <vulnerabilities>
          <vulnerability>
            <type>localExploit</type>
            <cve>CVE-2011-4622</cve>
            <goal>privEscalation</goal>
            <cvss>4.9</cvss>
          </vulnerability>
        </vulnerabilities>
      </service>
    </services>
    <routes>
      <route>
        <destination>0.0.0.0</destination>
        <mask>0.0.0.0</mask>
        <gateway>192.168.1.254</gateway>
        <interface>eth0</interface>
      </route>
    </routes>
  </machine>
  <machine>
    <name>host2</name>
    <security_requirement>1</security_requirement>
    <controllers>
      <controller>orchestrateur_global</controller>
    </controllers>
    <interfaces>
      <interface>
        <name>eth0</name>
        <ipaddress>192.168.1.2</ipaddress>
        <vlan>
          <name>vlan0</name>
          <label>vlan0</label>
        </vlan>
      </interface>
    </interfaces>
    <services />
    <routes>
      <route>
        <destination>0.0.0.0</destination>
        <mask>0.0.0.0</mask>
        <gateway>192.168.1.254</gateway>
        <interface>eth0</interface>
      </route>
    </routes>
  </machine>
  <machine>
    <name>host3</name>
    <security_requirement>1</security_requirement>
    <controllers>
      <controller>orchestrateur_global</controller>
    </controllers>
    <interfaces>
      <interface>
        <name>eth0</name>
        <ipaddress>192.168.1.3</ipaddress>
        <vlan>
          <name>vlan0</name>
          <label>vlan0</label>
        </vlan>
      </interface>
    </interfaces>
    <services>
      <service>
        <name>kvm</name>
        <ipaddress>192.168.1.3</ipaddress>
        <protocol>none</protocol>
        <port>0</port>
        <global_name>host3_kvm</global_name>
        <vulnerabilities>
          <vulnerability>
            <type>localExploit</type>
            <cve>CVE-2011-4622</cve>
            <goal>privEscalation</goal>
            <cvss>4.9</cvss>
          </vulnerability>
        </vulnerabilities>
      </service>
    </services>
    <routes>
      <route>
        <destination>0.0.0.0</destination>
        <mask>0.0.0.0</mask>
        <gateway>192.168.1.254</gateway>
        <interface>eth0</interface>
      </route>
    </routes>
  </machine>
  <machine>
    <name>host4</name>
    <security_requirement>1</security_requirement>
    <controllers>
      <controller>orchestrateur_global</controller>
    </controllers>
    <interfaces>
      <interface>
        <name>eth0</name>
        <ipaddress>192.168.1.4</ipaddress>
        <vlan>
          <name>vlan0</name>
          <label>vlan0</label>
        </vlan>
      </interface>
    </interfaces>
    <services />
    <routes>
      <route>
        <destination>0.0.0.0</destination>
        <mask>0.0.0.0</mask>
        <gateway>192.168.1.254</gateway>
        <interface>eth0</interface>
      </route>
    </routes>
  </machine>
  <machine>
    <name>ndn1</name>
    <security_requirement>0</security_requirement>
    <physical_host>
      <hostname>host2</hostname>
      <hypervisor>kvm</hypervisor>
      <user>root</user>
    </physical_host>
    <controllers>
      <controller>orchestrateur_global</controller>
    </controllers>
    <interfaces />
    <faces>
      <face>
        <name>igw</name>
      </face>
      <face>
        <name>r2</name>
      </face>
      <face>
        <name>r3</name>
      </face>
    </faces>
    <services>
      <service>
        <name>NFD</name>
        <protocol>ndn</protocol>
        <port>0</port>
        <vulnerabilities>
          <vulnerability>
            <type>localExploit</type>
            <cve>NDN-2017-0002</cve>
            <goal>privEscalation</goal>
            <cvss>9.2</cvss>
          </vulnerability>
        </vulnerabilities>
      </service>
    </services>
    <routes />
  </machine>
  <machine>
    <name>ndn2</name>
    <security_requirement>0</security_requirement>
    <physical_host>
      <hostname>host3</hostname>
      <hypervisor>kvm</hypervisor>
      <user>root</user>
    </physical_host>
    <controllers>
      <controller>orchestrateur_global</controller>
    </controllers>
    <interfaces />
    <faces>
      <face>
        <name>r1</name>
      </face>
      <face>
        <name>r4</name>
      </face>
    </faces>
    <services>
      <service>
        <name>NFD</name>
        <protocol>ndn</protocol>
        <port>0</port>
        <vulnerabilities>
          <vulnerability>
            <type>localExploit</type>
            <cve>NDN-2017-0002</cve>
            <goal>privEscalation</goal>
            <cvss>9.2</cvss>
          </vulnerability>
        </vulnerabilities>
      </service>
    </services>
    <routes />
  </machine>
  <machine>
    <name>ndn3</name>
    <security_requirement>0</security_requirement>
    <physical_host>
      <hostname>host2</hostname>
      <hypervisor>kvm</hypervisor>
      <user>root</user>
    </physical_host>
    <controllers>
      <controller>orchestrateur_global</controller>
    </controllers>
    <interfaces />
    <faces>
      <face>
        <name>r1</name>
      </face>
      <face>
        <name>r4</name>
      </face>
    </faces>
    <services>
      <service>
        <name>NFD</name>
        <protocol>ndn</protocol>
        <port>0</port>
        <vulnerabilities>
          <vulnerability>
            <type>signatureExploit</type>
            <cve>NDN-2017-0001</cve>
            <goal>cachedPoisonned</goal>
            <cvss>6.5</cvss>
          </vulnerability>
        </vulnerabilities>
      </service>
    </services>
    <routes />
  </machine>
  <machine>
    <name>ndn4</name>
    <security_requirement>0</security_requirement>
    <physical_host>
      <hostname>host3</hostname>
      <hypervisor>kvm</hypervisor>
      <user>root</user>
    </physical_host>
    <controllers>
      <controller>orchestrateur_global</controller>
    </controllers>
    <interfaces />
    <faces>
      <face>
        <name>r2</name>
      </face>
      <face>
        <name>r3</name>
      </face>
      <face>
        <name>r5</name>
      </face>
      <face>
        <name>r6</name>
      </face>
    </faces>
    <services>
      <service>
        <name>NFD</name>
        <protocol>ndn</protocol>
        <port>0</port>
        <vulnerabilities>
          <vulnerability>
            <type>signatureExploit</type>
            <cve>NDN-2017-0001</cve>
            <goal>cachedPoisonned</goal>
            <cvss>6.5</cvss>
          </vulnerability>
        </vulnerabilities>
      </service>
    </services>
    <routes />
  </machine>
  <machine>
    <name>ndn5</name>
    <security_requirement>0</security_requirement>
    <physical_host>
      <hostname>host3</hostname>
      <hypervisor>kvm</hypervisor>
      <user>root</user>
    </physical_host>
    <controllers>
      <controller>orchestrateur_global</controller>
    </controllers>
    <interfaces />
    <faces>
      <face>
        <name>r4</name>
      </face>
      <face>
        <name>r6</name>
      </face>
    </faces>
    <services>
      <service>
        <name>NFD</name>
        <protocol>ndn</protocol>
        <port>0</port>
      </service>
    </services>
    <routes />
  </machine>
  <machine>
    <name>ndn6</name>
    <security_requirement>0</security_requirement>
    <physical_host>
      <hostname>host3</hostname>
      <hypervisor>kvm</hypervisor>
      <user>root</user>
    </physical_host>
    <controllers>
      <controller>orchestrateur_global</controller>
    </controllers>
    <interfaces />
    <faces>
      <face>
        <name>r4</name>
      </face>
      <face>
        <name>r5</name>
      </face>
      <face>
        <name>egw</name>
      </face>
    </faces>
    <services>
      <service>
        <name>NFD</name>
        <protocol>ndn</protocol>
        <port>0</port>
        <vulnerabilities>
          <vulnerability>
            <type>localExploit</type>
            <cve>NDN-2017-0002</cve>
            <goal>privEscalation</goal>
            <cvss>9.2</cvss>
          </vulnerability>
        </vulnerabilities>
      </service>
    </services>
    <routes />
  </machine>
  <ndn-links>
    <ndn-link>
      <host-src>ndn1</host-src>
      <face-src>igw</face-src>
      <host-dst>igw</host-dst>
      <face-dst>r1</face-dst>
    </ndn-link>
    <ndn-link>
      <host-src>ndn1</host-src>
      <face-src>r2</face-src>
      <host-dst>ndn2</host-dst>
      <face-dst>r1</face-dst>
    </ndn-link>
    <ndn-link>
      <host-src>ndn1</host-src>
      <face-src>r3</face-src>
      <host-dst>ndn3</host-dst>
      <face-dst>r1</face-dst>
    </ndn-link>
    <ndn-link>
      <host-src>ndn2</host-src>
      <face-src>r4</face-src>
      <host-dst>ndn4</host-dst>
      <face-dst>r2</face-dst>
    </ndn-link>
    <ndn-link>
      <host-src>ndn3</host-src>
      <face-src>r4</face-src>
      <host-dst>ndn4</host-dst>
      <face-dst>r3</face-dst>
    </ndn-link>
    <ndn-link>
      <host-src>ndn4</host-src>
      <face-src>r5</face-src>
      <host-dst>ndn5</host-dst>
      <face-dst>r4</face-dst>
    </ndn-link>
    <ndn-link>
      <host-src>ndn4</host-src>
      <face-src>r6</face-src>
      <host-dst>ndn6</host-dst>
      <face-dst>r4</face-dst>
    </ndn-link>
    <ndn-link>
      <host-src>ndn5</host-src>
      <face-src>r6</face-src>
      <host-dst>ndn6</host-dst>
      <face-dst>r5</face-dst>
    </ndn-link>
    <ndn-link>
      <host-src>ndn6</host-src>
      <face-src>egw</face-src>
      <host-dst>egw</host-dst>
      <face-dst>r6</face-dst>
    </ndn-link>
  </ndn-links>
  <flow-matrix>
    <flow-matrix-line>
      <source resource="vlan1" type="VLAN" />
      <destination resource="vlan2" type="VLAN" />
      <source_port>any</source_port>
      <destination_port>80</destination_port>
      <protocol>TCP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source resource="vlan2" type="VLAN" />
      <destination resource="vlan1" type="VLAN" />
      <source_port>80</source_port>
      <destination_port>any</destination_port>
      <protocol>TCP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source resource="vlan3" type="VLAN" />
      <destination resource="vlan4" type="VLAN" />
      <source_port>any</source_port>
      <destination_port>80</destination_port>
      <protocol>TCP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source resource="vlan4" type="VLAN" />
      <destination resource="vlan3" type="VLAN" />
      <source_port>80</source_port>
      <destination_port>any</destination_port>
      <protocol>TCP</protocol>
    </flow-matrix-line>
  </flow-matrix>
</topology>
